version: 1
frontend:
  phases:
    preBuild:
      commands:
        - |
          if command -v sudo >/dev/null 2>&1; then
            SUDO=sudo
          else
            SUDO=""
          fi

          if command -v yum >/dev/null 2>&1; then
            $SUDO yum install -y libatomic
          else
            $SUDO apt-get update && $SUDO apt-get install -y libatomic1
          fi
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
redirects:
  - source: /index.html
    target: /en/
    status: 301
  - source: /
    target: /en/
    status: 301
